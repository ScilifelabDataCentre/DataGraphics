{# Button and modal for creating a graphic. #}

<button type="button" class="btn btn-primary btn-sm btn-block"
        data-toggle="modal" data-target="#createGraphicModal">
  Create graphic
</button>

<div class="modal fade" id="createGraphicModal" tabindex="-1" role="dialog"
     aria-labelledby="createGraphicModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
    <div class="modal-content">
      <form action="{{ url_for('graphic.create') }}"
            enctype="multipart/form-data"
            method="POST">
        {{ csrf_token() }}
        <input type="hidden" name="dataset" value="{{ dataset['_id'] }}">
        <div class="modal-header">
          <h5 class="modal-title" id="createGraphicModalLabel">Create graphic</h5>
          <button type="button" class="close" data-dismiss="modal"
                  aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <div class="form-group row">
            <label for="title"
	           class="col-md-2 col-form-label text-right font-weight-bold">
              Title</label>
            <div class="col-md">
              <input type="text" id="title" name="title"
                     class="form-control" aria-describedby="titleHelp">
              <small id="titleHelp" class="form-text text-muted">
                Single-line descriptive title for the graphic.
              </small>
            </div>
          </div>
          <div class="form-group row">
            <label for="description"
	           class="col-md-2 col-form-label text-right font-weight-bold">
              Description</label>
            <div class="col-md">
              <textarea id="description" name="description" rows="4"
                        class="form-control"
                        aria-describedby="descriptionHelp"></textarea>
              <small id="descriptionHelp" class="form-text text-muted">
                Description of the graphic. Formatted using Markdown.
              </small>
            </div>
          </div>
          <div class="form-group row">
            <label for="specification"
	           class="col-md-2 col-form-label text-right font-weight-bold">
              Specification</label>
            <div class="col-md">
              <textarea id="specification" name="specification" rows="14"
                        class="form-control"
                        aria-describedby="specificationHelp"
>{
  "$schema": "{{ config['VEGA_LITE_SCHEMA_URL'] }}",
  "title": "dataset['title']",
  "data": {
    "url": "{{ url_for('api_dataset.content', iuid=dataset['_id'], ext='csv', _external=True) }}",
    "format": {"type": "csv"}
  }
}
</textarea>
              <small id="specificationHelp" class="form-text text-muted">
                Specification of the graphic using
                <a href="https://vega.github.io/vega-lite/">Vega-Lite</a> JSON.
                <br>
                <strong>
                  The items <code>$schema</code>, <code>title</code>
                  and <code>data</code> are fixed, and attempts to
                  change them will be overruled when saving.
                </strong>
              </small>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary"
                  data-dismiss="modal">Cancel</button>
          <button type="submit" class="btn btn-primary">Create graphic</button>
        </div>
      </form>
    </div>
  </div>
</div>
