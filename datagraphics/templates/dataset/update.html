{% extends 'base.html' %}

{% block head_title %}Update {{ dataset['title'] }}{% endblock %}

{% block body_title %}Update {{ dataset['title'] }}{% endblock %}

{% block main %}
<p class="lead">
  Update this dataset by uploading new data from a file or URL. The
  new data must have the same column definitions. All values in this
  dataset will be replaced by the new data.
</p>

<form action="{{ url_for('.update', iuid=dataset['_id']) }}"
      enctype="multipart/form-data"
      method="POST">
  {{ csrf_token() }}

  <div class="form-group row">
    <label for="file"
	   class="col-md-2 col-form-label text-right font-weight-bold">
      File</label>
    <div class="col-md">
      <input type="file" id="file" name="file"
	     class="form-control-file" aria-describedby="fileHelp">
      <small id="fileHelp" class="form-text text-muted">
        Upload the file containing the new data from your local machine.
        CSV or JSON format. If given, will override any URL given below.
      </small>
    </div>
  </div>

  <div class="form-group row">
    <label for="url"
	   class="col-md-2 col-form-label text-right font-weight-bold">
      URL</label>
    <div class="col-md">
      <input type="text" id="url" name="url"
             class="form-control" aria-describedby="urlHelp">
      <small id="urlHelp" class="form-text text-muted">
        URL to upload the dataset from. CSV or JSON format. This is
        appropriate for fetching data from a
        <a href="https://github.com/pekrau/DbShare" target="_blank">DbShare</a>
        instance. This is ignored if a file is given above.
      </small>
    </div>
  </div>

  <div class="form-group row">
    <label for="url"
	   class="col-md-2 col-form-label text-right font-weight-bold">
      API key</label>
    <div class="col-md">
      <input type="password" id="apikey" name="apikey"
             class="form-control" aria-describedby="apikeyHelp">
      <small id="apikeyHelp" class="form-text text-muted">
        API key to use when accessing the URL given above, if it is
        not publicly accessible. This works with DbShare.
      </small>
    </div>
  </div>

  <div class="form-group row">
    <div class="col-md-3 offset-md-2">
      <button type="submit" class="btn btn-block btn-primary">Update</button>
    </div>
  </div>
</form>
{% endblock %} {# block main #}

{% block actions %}
<div class="mt-2">
  <a href="{{ url_referrer(url_for('datasets.user', username=g.current_user['username'])) }}"
     role="button" class="btn btn-block btn-secondary">Cancel</a>
</div>
{% endblock %}
